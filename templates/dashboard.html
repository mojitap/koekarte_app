{% extends "base.html" %}

{% block title %}マイページ - コエカルテ{% endblock %}

{% block content %}
<div class="dashboard-card">
  <h1>{{ user.username }}さんのマイページ</h1>

  <div class="profile-info">
    <p>📧 <strong>メールアドレス：</strong>{{ user.email }}</p>
    <p>🏠 <strong>地域：</strong>{{ user.prefecture }}</p>
    <p>👤 <strong>性別：</strong>{{ user.gender }}</p>
    <p>🎂 <strong>生年月日：</strong>{{ user.birthdate }}</p>
    <p>💼 <strong>職業：</strong>{{ user.occupation or "未設定" }}</p>
  </div>

  <hr>

  {% if first_score is not none %}
  <div class="score-summary">
    <p>📅 <strong>登録日：</strong>{{ first_score_date }}</p>
    <p>🔢 <strong>初回スコア：</strong>{{ first_score }}</p>
    <p>📝 <strong>今日のスコア：</strong>{{ latest_score }}</p>
    <p>📊 <strong>スコア差分：</strong>{{ diff }}ポイント（ストレス{% if diff > 0 %}上昇{% elif diff < 0 %}減少{% else %}変化なし{% endif %}）</p>
  </div>
  {% else %}
  <p>まだスコアが記録されていません。録音ページから初回スコアを登録してください。</p>
  {% endif %}

  <div class="actions">
    <p>🎙️ <a href="/record" class="button">録音ページへ</a></p>
    <p>📈 <a href="/result" class="button">グラフを見る</a></p>
    
    <p>📥 <a href="/export_csv" class="button">CSVでダウンロード</a></p>
  </div>

  <div class="logout">
    <a href="/logout">🚪 ログアウト</a>
  </div>
</div>
{% endblock %}
