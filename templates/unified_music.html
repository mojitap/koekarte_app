{% extends "base.html" %}
{% block title %}éŸ³æºãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ - ã‚³ã‚¨ã‚«ãƒ«ãƒ†{% endblock %}

{% block content %}
<div style="max-width: 700px; margin: 0 auto;">
  <h2>ğŸ§ éŸ³æºãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼</h2>
  <p>ç„¡æ–™ãƒ»æœ‰æ–™éŸ³æºã‚’ã“ã¡ã‚‰ã‹ã‚‰ã”åˆ©ç”¨ã„ãŸã ã‘ã¾ã™ã€‚</p>

  <div class="music-info" style="margin-top: 30px;">
    <p><strong>ğŸµ éŸ³å£°ã‹ã‚‰ã ã‘ã§ãªãã€éŸ³æ¥½ã§ã‚‚å¿ƒã®ã‚±ã‚¢ã‚’ã€‚</strong><br>
    ã‚³ã‚¨ã‚«ãƒ«ãƒ†ã§ã¯ã€å¿ƒã®çŠ¶æ…‹ã‚„ç›®çš„ã«åˆã‚ã›ãŸéŸ³æºã‚‚ã”ç”¨æ„ã—ã¦ã„ã¾ã™ã€‚éŒ²éŸ³ã‚„ã‚¹ã‚³ã‚¢è¨˜éŒ²ã¨ã‚ã‚ã›ã¦ã”æ´»ç”¨ãã ã•ã„ã€‚</p>

    <ul style="padding-left: 1.2em; font-size: 14px;">
      <li><strong>ãƒªãƒ©ãƒƒã‚¯ã‚¹</strong>ï¼šç·Šå¼µã‚„ä¸å®‰ã‚’ã»ãã—ã€å‰¯äº¤æ„Ÿç¥çµŒã‚’ä¿ƒé€²</li>
      <li><strong>æ•´ãˆã‚‹ãƒ»é›†ä¸­</strong>ï¼šæ€è€ƒã‚’æ•´ãˆã€æ³¨æ„ã‚’å®‰å®šã•ã›ã‚‹éŸ³</li>
      <li><strong>æ°—åˆ†ã‚’ä¸Šã’ã‚‹</strong>ï¼šæ˜ã‚‹ãå‰å‘ããªãƒ¡ãƒ­ãƒ‡ã‚£ã§æ´»åŠ›ã‚’ã‚µãƒãƒ¼ãƒˆ</li>
    </ul>

    <p style="font-size: 13px; color: gray;">
      â€»éŸ³æºã¯å€‹äººã®ç›®çš„ã‚„å¥½ã¿ã«å¿œã˜ã¦è‡ªç”±ã«é¸ã‚“ã§ã”åˆ©ç”¨ã„ãŸã ã‘ã¾ã™ã€‚
    </p>
  </div>
  
  <h3>ğŸ”“ ç„¡æ–™éŸ³æº</h3>
  <ul style="text-align: left; list-style-position: inside; padding-left: 1em;">
    <li>
      <p>ãƒã‚¸ãƒ†ã‚£ãƒ–</p>
      <audio controls style="width: 100%;">
        <source src="{{ url_for('static', filename='free/free-positive.mp3') }}">
      </audio>
    </li>
      <p>ãƒã‚¤ãƒ³ãƒ‰ãƒ•ãƒ«ãƒã‚¹</p>
      <audio controls style="width: 100%;">
        <source src="{{ url_for('static', filename='free/free-mindfulness.mp3') }}">
      </audio>
    </li>
    <li>
      <p>ãƒªãƒ©ã‚¯ã‚¼ãƒ¼ã‚·ãƒ§ãƒ³</p>
      <audio controls style="width: 100%;">
        <source src="{{ url_for('static', filename='free/free-relaxation.mp3') }}">
      </audio>
    </li>
  </ul>

  <h3 style="margin-top: 40px;">ğŸŸ ãƒ—ãƒ¬ãƒŸã‚¢ãƒ éŸ³æº</h3>

  {% if not current_user.is_paid and current_user.created_at %}
    {% set remaining_days = 5 - (date.today() - current_user.created_at.date()).days %}
    <div style="padding: 10px; border: 1px solid #faa; border-radius: 6px; background-color: #fff0f0; margin: 10px 0;">
      {% if remaining_days > 0 %}
        <p style="font-size: 14px; color: #a00;">
          ğŸ•’ ç„¡æ–™æœŸé–“ã¯ã‚ã¨ <strong>{{ remaining_days }}</strong> æ—¥ã§ã™ã€‚<br>
          çµ‚äº†å¾Œã¯éŒ²éŸ³ãƒ»åˆ†æãƒ»ã‚¹ã‚³ã‚¢ã‚°ãƒ©ãƒ•ãƒ»éŸ³æ¥½ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®åˆ©ç”¨ã«åˆ¶é™ãŒã‹ã‹ã‚Šã¾ã™ã€‚
        </p>
      {% else %}
        <p style="font-size: 14px; color: #a00;">
          âš ï¸ ç„¡æ–™æœŸé–“ã¯çµ‚äº†ã—ã¾ã—ãŸã€‚<br>å¼•ãç¶šãã”åˆ©ç”¨ã„ãŸã ãã«ã¯ã€æœ‰æ–™ãƒ—ãƒ©ãƒ³ï¼ˆæœˆé¡300å††ï¼‰ã¸ã®ç™»éŒ²ãŒå¿…è¦ã§ã™ã€‚
        </p>
      {% endif %}
      <a href="{{ url_for('checkout') }}" class="btn btn-warning">ğŸŸ ä»Šã™ãæœ‰æ–™ç™»éŒ²ã™ã‚‹</a>
    </div>
  {% endif %}
    
  {% if can_play_premium %}
    {% set categories = {'ãƒã‚¸ãƒ†ã‚£ãƒ–': [], 'ãƒªãƒ©ãƒƒã‚¯ã‚¹': [], 'ãƒã‚¤ãƒ³ãƒ‰ãƒ•ãƒ«ãƒã‚¹': []} %}
    {% for track in tracks %}
      {% if 'positive' in track.filename %}
        {% set _ = categories['ãƒã‚¸ãƒ†ã‚£ãƒ–'].append(track) %}
      {% elif 'relax' in track.filename %}
        {% set _ = categories['ãƒªãƒ©ãƒƒã‚¯ã‚¹'].append(track) %}
      {% elif 'mindfulness' in track.filename %}
        {% set _ = categories['ãƒã‚¤ãƒ³ãƒ‰ãƒ•ãƒ«ãƒã‚¹'].append(track) %}
      {% endif %}
    {% endfor %}

    {% for label, group in categories.items() %}
      <h4 class="toggle-header">ğŸ¶ {{ label }}ç³»</h4>
      <div class="toggle-content">
        <ul style="list-style: none; padding: 0;">
          {% for track in group %}
          <li style="margin-bottom: 20px;">
            <p>{{ track.display }}</p>
            <audio controls style="width: 100%;">
              <source src="{{ url_for('static', filename='paid/' + track.filename) }}" type="audio/mpeg">
            </audio>
          </li>
          {% endfor %}
        </ul>
      </div>
    {% endfor %}
  {% endif %}

  <a href="/dashboard" class="auth-links">ğŸ  ãƒã‚¤ãƒšãƒ¼ã‚¸ã«æˆ»ã‚‹</a>
</div>

<script>
document.addEventListener('DOMContentLoaded', () => {
  document.querySelectorAll('.toggle-header').forEach(header => {
    header.addEventListener('click', () => {
      const next = header.nextElementSibling;
      next.style.display = next.style.display === 'none' ? 'block' : 'none';
    });
  });
});
</script>

<style>
.toggle-header {
  cursor: pointer;
  background-color: #f5f5f5;
  padding: 8px;
  border-radius: 5px;
  margin-top: 15px;
}
.toggle-content {
  display: none;
}
</style>
{% endblock %}
